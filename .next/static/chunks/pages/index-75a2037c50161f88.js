(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5838)}])},6422:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var a=n(5893),i=n(7337),r=n(3464),s=n(3137),o=n(5777),l=n.n(o),c=n(4319),d=n(9706),u=n.n(d);function m(e){var t=e.label,n=e.size,o=void 0===n?"md":n,d=e.id,m=e.name,_=e.value,g=e.onChange,h=e.error,p=e.info,f=e.options,v=e.noInfo,x=void 0!==v&&v,j=e.style,y=e.customStyles,w=void 0===y?[]:y,k=(0,r.C)(s.i2),b=(h=h||k&&k[d])&&(!h.value&&!_||h.value&&h.value===_),Z=[l().input,l()[o],w.map((function(e){return l()[e]})).join(" "),b?l().input_error:"",u().select].join(" ").trim();return(0,a.jsxs)("div",{className:l()._,children:[(0,a.jsxs)("div",{className:[l()._input,t?u().with_label:"",u()._select,u()[o]].join(" ").trim(),children:[(0,a.jsx)("select",{id:d,name:m||d,className:Z,value:_,onChange:g,style:j,children:f.map((function(e){if(e)return"string"===typeof e?(0,a.jsx)("option",{value:e,children:e},e):(0,a.jsx)("option",{value:e.value,children:e.key},e.value)}))}),(0,a.jsx)(c.Z,{htmlFor:d,className:l().input_label,children:t}),(0,a.jsx)(i.zgq,{className:u().chevron,size:16})]}),x?null:(0,a.jsx)("div",{className:l()._info,children:b?(0,a.jsxs)("div",{className:l().error,children:[(0,a.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{d:"M12 8V12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M12 16.0195V16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),h.msg]}):p?(0,a.jsx)("div",{className:l().info,children:p}):null})]})}},5838:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ve}});var a=n(5893),i=n(4038),r=n(7568),s=n(4924),o=n(6042),l=n(9396),c=n(828),d=n(9815),u=n(655),m=n(6154),_=n(7484),g=n.n(_),h=n(4820),p=n(7337),f=n(7294),v=n(7081),x=n.n(v);function j(e){var t=e.title,n=e.children,i=e.icon,r=e.align,s=void 0===r?"left":r,o=e.style,l=void 0===o?"default":o,c=e.openByDefault,d=void 0!==c&&c,u=e.tag,m=(0,f.useState)(d),_=m[0],g=m[1];return(0,a.jsxs)("div",{className:[x()._,x()[l],x()[s],_?x()._open:""].join(" "),children:[(0,a.jsxs)("div",{className:x()._head,onClick:function(){g(!_)},children:[(0,a.jsxs)("div",{className:x().head,children:[i||"",(0,a.jsx)("h4",{className:x().title,children:t}),u?(0,a.jsx)("span",{className:x().tag,children:u}):null]}),(0,a.jsx)("div",{className:x().chevron,children:(0,a.jsx)(p.zgq,{size:16,strokeWidth:3})})]}),(0,a.jsx)("div",{className:[x()._content,_?x().open:""].join(" "),children:(0,a.jsx)("div",{className:x().content,children:n})})]})}var y=n(4200),w=n(433),k=n(3718),b=n(3025),Z=n(5675),N=n.n(Z),S=n(7551),C=n(6961),D=n.n(C);function M(e){var t=e.text,n=e.children,i=e.disabled,r=void 0!==i&&i,s=e.type,o=void 0===s?"default":s,l=e.position,c=void 0===l?"left":l;return(0,a.jsxs)("div",{className:[D()._,D()[o]].join(" "),children:[(0,a.jsx)("div",{className:D().content,children:n}),r?null:(0,a.jsx)("div",{className:[D()._tooltip,D()[c]].join(" "),children:(0,a.jsx)("div",{className:D().tooltip,children:(0,a.jsx)("span",{children:t})})})]})}var P=n(2572),I=n.n(P);function z(e){var t,n,i,r,s=e.image,o=e.onCopyParams,l=e.onCopyImage,c=e.onSelect,d=e.onDelete,u=(e.onUpscale,e.onEnhanceFace,e.actions),m=void 0===u?["like","delete","upscale","enhance_faces","copy_params","copy_image"]:u,_=e.imageLoader,g=e.hoverable,p=void 0===g||g,v=(0,f.useState)(0),x=v[0],j=v[1],Z=(0,f.useState)(s.liked);Z[0],Z[1];return(0,f.useEffect)((function(){j(0)}),[]),(0,f.useEffect)((function(){s.loading&&setTimeout((function(){j(x+.1)}),100)}),[s.loading,x]),s.loading?(0,a.jsx)("div",{className:I().image,style:{paddingBottom:s.height/s.width*100+"%"},children:(0,a.jsx)("div",{className:I().loading,children:(0,a.jsx)(S.Z,{text:"".concat((Math.round(10*x)/10).toFixed(1),"s")})})}):(0,a.jsx)("div",{className:I().image,children:(0,a.jsxs)("div",{className:[I().img].join(" "),children:[(0,a.jsx)(N(),{src:s.url,alt:"",width:s.width,height:s.height,loader:_,unoptimized:!_&&s.width<=1024&&s.height<=1024}),(0,a.jsxs)("div",{className:[I().img_hover,p?I().hoverable:""].join(" "),onClick:function(){return c&&c(s)},children:[(0,a.jsx)("div",{className:I().img_hover_row,children:(0,a.jsxs)("div",{className:I().btn_group,children:[((null===(t=s.modelTask.model)||void 0===t?void 0:t.includes("stable-diffusion"))||(null===(n=s.modelTask.model)||void 0===n?void 0:n.includes("model-"))||"instruct-pix2pix"===s.modelTask.model||"image-mixer"===s.modelTask.model)&&m.includes("copy_params")&&o?(0,a.jsx)(M,{text:"Use\xa0parameters\xa0again",type:"button",children:(0,a.jsx)(h.Z,{onClick:function(e){e.stopPropagation(),o(s)},size:"md",type:"transparent",children:(0,a.jsx)(y.Z,{strokeWidth:1.5})})}):null,((null===(i=s.modelTask.model)||void 0===i?void 0:i.includes("stable-diffusion"))||(null===(r=s.modelTask.model)||void 0===r?void 0:r.includes("model-"))||"instruct-pix2pix"===s.modelTask.model||"image-mixer"===s.modelTask.model)&&m.includes("copy_image")&&l?(0,a.jsx)(M,{text:"Use\xa0as\xa0init\xa0image",type:"button",children:(0,a.jsx)(h.Z,{onClick:function(e){e.stopPropagation(),l(s)},size:"md",type:"transparent",children:(0,a.jsx)(w.Z,{strokeWidth:1.5})})}):null]})}),(0,a.jsxs)("div",{className:I().img_hover_row,children:[(0,a.jsx)("div",{className:I().btn_group,children:m.includes("delete")&&d?(0,a.jsx)(h.Z,{onClick:function(e){e.stopPropagation(),d(s)},size:"md",type:"transparent",children:(0,a.jsx)(k.Z,{strokeWidth:1.5})}):null}),(0,a.jsx)("div",{className:I().btn_group,children:m.includes("download")?(0,a.jsx)(h.Z,{onClick:function(e){e.stopPropagation()},size:"md",type:"transparent",href:"/api/download/".concat(s.id),download:"getimg_ai_".concat(s.id,".").concat(s.format.toLowerCase()),children:(0,a.jsx)(b.Z,{strokeWidth:1.5})}):null})]})]})]})})}var E=(0,f.memo)(z),L=n(42),W=n(9580),F=n(1955),T=n(9503),K=n(1352),H=n(4830),B=n.n(H);function A(e){var t=e.children,n=e.title,i=e.id,r=(0,f.useState)(!1),s=r[0],o=r[1];return(0,f.useEffect)((function(){F.Z.get(i+"-tip")||o(!0)}),[]),s?(0,a.jsxs)("div",{className:B().tip,children:[n?(0,a.jsxs)("div",{className:B().tip_title,children:[(0,a.jsx)(T.Z,{size:18}),n]}):null,t,(0,a.jsx)("button",{className:[B().tip_close,n?B().title_close:""].join(" "),onClick:function(){F.Z.set(i+"-tip",g()().unix().toString(),{expires:g()().add(24,"months").toDate()}),o(!1)},children:(0,a.jsx)(K.Z,{size:14})})]}):null}var U=n(7764),O=n(1787),q=n(4201),G=n(7558),Q=n(9706),V=n.n(Q);function X(e){var t=e.onChange,n=e.models,i=e.value,r=e.id,s=function(e){t(e),c(!1)},o=(0,f.useState)(!1),l=o[0],c=o[1],u=(0,f.useState)(""),m=u[0],_=u[1],g=(0,d.Z)(n),h=g.find((function(e){return e.id===i}));return(0,a.jsxs)("div",{className:V()._model_select,children:[(0,a.jsx)("div",{onClick:function(){return c(!0)},children:(0,a.jsxs)("div",{className:[V().selected_model].join(" "),children:[(0,a.jsx)(N(),{src:h&&h.params.images[2],width:16,height:16,loader:q.O}),"Model: ",h?h.name:"Undefined",(0,a.jsxs)("span",{className:V().tag,children:[10*Math.floor(g.length/10),"+"]}),(0,a.jsx)("div",{className:V().arrow,children:(0,a.jsx)(p.zgq,{size:16,strokeWidth:3})})]})}),(0,a.jsx)("div",{children:(0,a.jsx)(G.Z,{onClose:function(){return c(!1)},title:(0,a.jsxs)("div",{className:V().model_search,children:[(0,a.jsx)("span",{children:"Select Model"}),(0,a.jsx)("div",{className:V().search,children:(0,a.jsx)(W.Z,{size:"sm",id:"textFilter",value:m,onChange:function(e){return _(e.target.value)},placeholder:"Search",Icon:U.Z,disableInfo:!0,customStyles:["no-margin"]})})]}),show:l,size:"lg",children:(0,a.jsx)("div",{className:V().models_list,children:g.filter((function(e){return(e.name+" "+e.params.description).toLowerCase().search(m.toLowerCase())>-1})).map((function(e){var t;return(0,a.jsx)("label",{htmlFor:r+e.id,className:[V()._model,e.id.toString()===i?V().checked:""].join(" "),children:(0,a.jsxs)("div",{className:V().model,children:[(0,a.jsx)("div",{className:V().model_images,children:e.params.images&&(null===(t=e.params.images)||void 0===t?void 0:t.map((function(e,t){return(0,a.jsx)(N(),{src:e,width:100,height:100,loader:q.O},t)})))}),(0,a.jsxs)("div",{className:V().model_info,children:[(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:V().model_name,children:e.name})}),e.params.author_url?(0,a.jsxs)("div",{className:V().model_author,children:["by ",(0,a.jsxs)("a",{onClick:function(e){return e.stopPropagation()},target:"_blank",rel:"noreferrer",href:e.params.author_url,children:[(0,a.jsx)(O.Z,{size:13}),e.params.author]})]}):null]}),(0,a.jsx)("input",{name:r,id:r+e.id,type:"radio",value:e.id,checked:e.id===i,onChange:s,className:V().model_input}),e.id===i?(0,a.jsx)("div",{className:V().checked_icon,children:(0,a.jsx)(p.y$4,{size:10,strokeWidth:4})}):null]})},e.id)}))})})})]})}var Y=n(6422),J=n(6171),R=n(4319);function $(e){return(0,a.jsxs)("div",{children:[e.label?(0,a.jsx)(R.Z,{children:e.label}):null,(0,a.jsx)(J.Z,{min:e.min,max:e.max,step:e.step,value:e.value,onChange:e.onChange,railStyle:{background:"rgb(60, 63, 68)"},trackStyle:{backgroundColor:"#5866e6",opacity:.8},handleStyle:{borderWidth:3,borderColor:"#5866e6",backgroundColor:"rgb(60, 63, 68)",width:14,height:14,marginTop:-5,marginLeft:0,opacity:1}}),e.info?(0,a.jsx)("small",{className:"small",children:e.info}):null]})}var ee=n(3464),te=n(3137),ne=n(5777),ae=n.n(ne);function ie(e){var t=e.height,n=void 0===t?90:t,i=e.placeholder,r=e.label,s=e.id,o=e.name,l=e.error,c=e.value,d=e.onChange,u=e.autoFocus,m=e.info,_=e.autoComplete,g=void 0===_?"off":_,h=e.disabled,p=e.customStyles,v=void 0===p?[]:p,x=e.size,j=e.noInfo,y=e.onBlur,w=e.onFocus,k=(0,ee.C)(te.i2),b=(l=l||k&&k[s])&&(!l.value&&!c||l.value&&l.value===c),Z=(0,f.createRef)(),N=[ae().input,ae().textarea,ae()["textarea_"+x],b?ae().input_error:"",v.map((function(e){return ae()[e]})).join(" ")].join(" ").trim();return(0,f.useEffect)((function(){var e;u&&(null===(e=document.getElementById(s))||void 0===e||e.focus())}),[u]),(0,f.useEffect)((function(){!function(){var e=Z.current;e&&(e.style.height="inherit",e.style.height="".concat(e.scrollHeight+9,"px"))}()}),[c]),(0,a.jsxs)("div",{className:ae()._,children:[(0,a.jsxs)("div",{className:[ae()._input,r?ae().with_label:""].join(" ").trim(),children:[(0,a.jsx)("textarea",{id:s,name:o||s,className:N,value:c||"",onChange:d,autoComplete:g,placeholder:i,autoFocus:u,disabled:h,ref:Z,style:{minHeight:n},onBlur:y,onFocus:w}),(0,a.jsx)(R.Z,{htmlFor:s,className:ae().input_label,children:r})]}),j?null:(0,a.jsx)("div",{className:ae()._info,children:b?(0,a.jsxs)("div",{className:ae().error,children:[(0,a.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{d:"M12 8V12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M12 16.0195V16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.msg]}):m?(0,a.jsx)("div",{className:ae().info,children:m}):null})]})}var re=n(3779),se=(n(6486),n(6212)),oe=n(3058),le=n(6795),ce=n(5782),de=n(512),ue=n(8533),me=n(827),_e=n(9834),ge=n(3913),he=n.n(ge);function pe(e){var t=e.onChange,n=e.models,i=e.value,r=e.id,s=function(e){t(e),c(!1)},o=(0,f.useState)(!1),l=o[0],c=o[1],u=(0,f.useState)(""),m=(u[0],u[1],(0,d.Z)(n)),_=m.find((function(e){return e.id===i}));return(0,a.jsxs)("div",{className:V()._model_select,children:[(0,a.jsx)("div",{onClick:function(){return c(!0)},children:(0,a.jsxs)("div",{className:[V().selected_model].join(" "),children:["Node: ",_?_.name:"All",(0,a.jsx)("div",{className:V().arrow,children:(0,a.jsx)(p.zgq,{size:16,strokeWidth:3})})]})}),(0,a.jsx)("div",{children:(0,a.jsx)(G.Z,{onClose:function(){return c(!1)},title:"\u9009\u62e9\u8282\u70b9",show:l,size:"lg",children:(0,a.jsx)("div",{className:V().nodes_list,children:m.map((function(e){return(0,a.jsxs)("label",{htmlFor:r+e.id,className:[V()._node,e.id.toString()===i?V().checked:""].join(" "),children:[e.name,(0,a.jsx)("input",{name:r,id:r+e.id,type:"radio",value:e.id,checked:e.id===i,onChange:s,className:V().model_input}),e.id===i?(0,a.jsx)("div",{className:V().checked_icon,children:(0,a.jsx)(p.y$4,{size:10,strokeWidth:4})}):null]},e.id)}))})})})]})}function fe(){var e=function(e){R((0,l.Z)((0,o.Z)({},J),(0,s.Z)({},e.target.name,e.target.value)))},t=function(e){var t=e.target.id;e.dataTransfer.setData("text",t),I(t)},n=function(e){I(void 0)},i=(0,ee.T)(),_=(0,ee.C)(re.dy),p=(0,f.useState)([]),v=p[0],x=p[1],y=(0,f.useState)(void 0),w=y[0],k=y[1],b=(0,f.useState)("generate"),Z=b[0],N=b[1],S=(0,f.useState)({loading:!1,hasMore:!0}),C=S[0],D=S[1],M=(0,f.useState)(void 0),P=M[0],I=M[1],z=(0,f.useState)(!1),T=z[0],H=z[1],B=(0,f.useState)([]),U=B[0],O=B[1],q=(0,f.useState)([]),G=q[0],Q=q[1],V=(0,f.useState)({model:"",node:"all",prompt:"",negativePrompt:"Disfigured, cartoon, blurry",steps:25,guidanceScale:9,imageGuidance:1.5,seed:void 0,numImages:1,enhanceFace:"false",upscale:"false",width:512,height:512,scheduler:"DPM2",strength:.5,controlnet:"none",skipControlnetProcessing:"false",image:{url:""},images:[{url:"",strength:1},{url:"",strength:1}]}),J=V[0],R=V[1];function ne(){return ne=(0,r.Z)((function(){var e,t;return(0,u.__generator)(this,(function(n){switch(n.label){case 0:return[4,m.Z.get("/api/models?status=active&public=true")];case 1:return t=n.sent(),O((0,d.Z)(t.data)),(null===(e=t.data)||void 0===e?void 0:e.length)&&R((function(e){return""===e.model?(0,l.Z)((0,o.Z)({},e),{model:t.data[0].id}):e})),[2]}}))})),ne.apply(this,arguments)}function ae(){return(ae=(0,r.Z)((function(){var e;return(0,u.__generator)(this,(function(t){switch(t.label){case 0:return[4,m.Z.get("/api/nodes?status=active")];case 1:return e=t.sent(),Q([{id:"all",name:"All",domain:""}].concat((0,d.Z)(e.data))),[2]}}))}))).apply(this,arguments)}function ge(){return fe.apply(this,arguments)}function fe(){return(fe=(0,r.Z)((function(){var e,t;return(0,u.__generator)(this,(function(n){switch(n.label){case 0:if(!C.hasMore)return[2];e=!0,n.label=1;case 1:return n.trys.push([1,3,4,5]),D((0,l.Z)((0,o.Z)({},C),{loading:!0})),[4,m.Z.get("/api/images?tool=generator&take=24&skip="+v.length)];case 2:return t=n.sent(),x((0,d.Z)(v).concat((0,d.Z)(t.data))),e=t.data.length>0,[3,5];case 3:return n.sent(),x([]),[3,5];case 4:return D({loading:!1,hasMore:e}),[7];case 5:return[2]}}))}))).apply(this,arguments)}function ve(){return ve=(0,r.Z)((function(){var e,t,n,a,r,s;return(0,u.__generator)(this,(function(d){switch(d.label){case 0:return[4,navigator.clipboard.readText()];case 1:e=d.sent();try{t=e.split("\n"),n=t[0].trim(),a=t[1].replace("Negative prompt: ","").trim(),r=t[t.length-1],s=r.split(", "),R((function(e){var t={};return s.forEach((function(e){var n=(0,c.Z)(e.split(": "),2),a=n[0],r=n[1];switch(a){case"Seed":t.seed=r;break;case"Size":var s=(0,c.Z)(r.split("x"),2),o=s[0],l=s[1];t.width=parseInt(o),t.width>1024&&(t.width=1024),t.height=parseInt(l),t.height>1024&&(t.height=1024);break;case"Steps":t.steps=parseInt(r);break;case"CFG scale":t.guidanceScale=parseFloat(r);break;case"Sampler":t.scheduler=r;default:(0,te.yw)(i,{type:"info",text:"Unknown key: ".concat(a)})}})),(0,l.Z)((0,o.Z)({},e,t),{prompt:n,negativePrompt:a})}))}catch(u){i((0,te.YW)({message:"Invalid civitai config"}))}return[2]}}))})),ve.apply(this,arguments)}function xe(e){return je.apply(this,arguments)}function je(){return(je=(0,r.Z)((function(e){return(0,u.__generator)(this,(function(t){return T?((0,te.yw)(i,{type:"danger",text:"Please wait until current task is completed!"}),[2]):(De(void 0,"upscale",e),[2])}))}))).apply(this,arguments)}function ye(e){return we.apply(this,arguments)}function we(){return(we=(0,r.Z)((function(e){return(0,u.__generator)(this,(function(t){return T?((0,te.yw)(i,{type:"danger",text:"Please wait until current task is completed!"}),[2]):(De(void 0,"enhance-face",e),[2])}))}))).apply(this,arguments)}function ke(e){return be.apply(this,arguments)}function be(){return(be=(0,r.Z)((function(e){return(0,u.__generator)(this,(function(t){return R((function(t){return(0,l.Z)((0,o.Z)({},t),{image:(0,o.Z)({},t.image,e),width:Math.min(e.width,1024),height:Math.min(e.height,1024)})})),(0,te.yw)(i,{text:"Copied init image.",type:"success"}),[2]}))}))).apply(this,arguments)}function Ze(e){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,r.Z)((function(e){var t,n;return(0,u.__generator)(this,(function(a){return t=e.modelTask,n=e.modelTask.params,e.modelTask._model,R((function(e){var a=(0,o.Z)({},e);return"instruct-pix2pix"===t.model?N("edit"):"image-mixer"===t.model?N("mix"):(a.model=t.model.replace("-img2img","").replace("-inpaint","").replace("-txt2img",""),N("generate")),n.prompt&&(a.prompt=n.prompt),n.guidance_scale&&(a.guidanceScale=n.guidance_scale),n.image_guidance_scale&&(a.imageGuidance=n.image_guidance_scale),n.width&&(a.width=n.width),n.height&&(a.height=n.height),n.scheduler&&(a.scheduler=n.scheduler),n.num_inference_steps&&(a.steps=n.num_inference_steps),n.negative_prompt&&(a.negativePrompt=n.negative_prompt),n.strength&&(a.strength=n.strength),n.controlnet&&(a.controlnet=n.controlnet),n.seed&&(a.seed=n.seed),n.image_url&&(a.image=(0,l.Z)((0,o.Z)({},e.image),{url:n.image_url})),n.images&&n.images.length&&(a.images=(0,d.Z)(n.images)),console.log("copy Params",g()().format("HH:mm:ss:SSS")),a})),(0,te.yw)(i,{text:"Copied parameters.",type:"success"}),[2]}))}))).apply(this,arguments)}function Se(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=(0,r.Z)((function(e){return(0,u.__generator)(this,(function(t){try{m.Z.delete("/api/images?ids="+e.id),x((function(t){return t.filter((function(t){return t.id!==e.id}))}))}catch(n){(0,te.yw)(i,{type:"danger",text:"Unexpected Error!"})}return[2]}))}))).apply(this,arguments)}function De(e,t,n){return Me.apply(this,arguments)}function Me(){return Me=(0,r.Z)((function(e,t,n){var a,r,s,c,_,g,h,p,f,v,j,y,w,k,b,N,S,C;return(0,u.__generator)(this,(function(D){switch(D.label){case 0:if(e&&e.preventDefault(),i((0,te.b9)()),r="upscale"===(a=t||Z)||"enhance-face"===a?1:J.numImages,s="upscale"===a||"enhance-face"===a?1:J.numImages*(1+("true"===J.upscale?1:0)+("true"===J.enhanceFace?1:0)),T)return(0,te.yw)(i,{type:"danger",text:"Please wait until current task is completed!"}),[2];if(J.image&&J.image.loading)return(0,te.yw)(i,{text:"Please wait until image is fully loaded!",type:"info"}),[2];D.label=1;case 1:if(D.trys.push([1,6,7,8]),c=function(){var e,t,n,a,i,r,s,c;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return[4,m.Z.get("/api/tasks?ids="+S.join(","))];case 1:e=u.sent(),t=[],n=!0,a=!1,i=void 0;try{for(r=function(){var e,n=c.value;"succeed"===n.status&&n.images&&n.images.length&&(e=t).push.apply(e,(0,d.Z)(n.images.map((function(e){return(0,l.Z)((0,o.Z)({},e),{modelTask:n})}))));if("failed"===n.status)throw new Error("Something went wrong!")},s=e.data[Symbol.iterator]();!(n=(c=s.next()).done);n=!0)r()}catch(_){a=!0,i=_}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return x((function(e){for(var n=(0,d.Z)(e),a=[],i=0;i<t.length;i++){var r=t[i];n[S.length+i-1]=r,a.push(r.modelTask)}return S=S.filter((function(e){return!a.find((function(t){return t.id===e}))})),(0,d.Z)(n)})),[4,new Promise((function(e){return setTimeout(e,300)}))];case 2:return u.sent(),[2]}}))},H(!0),g={tool:"generator"},h=J.model,"generate"!==a&&"edit"!==a&&"mix"!==a||(g.num_inference_steps=J.steps,g.guidance_scale=J.guidanceScale,g.num_images=parseInt(J.numImages.toString()),g.width=J.width,g.height=J.height,g.enhance_face=J.enhanceFace,g.scheduler=J.scheduler,"true"===J.upscale&&(g.upscale=4),"true"===J.enhanceFace&&(g.enhance_face=!0)),"generate"===a||"edit"===a){if(g.prompt=J.prompt,!g.prompt)return(0,te.yw)(i,{text:"Text prompt is required for generation!",type:"danger"}),[2];if("edit"===a&&(!J.image||!J.image.url))return(0,te.yw)(i,{text:"Image is required for Editing!",type:"danger"}),[2];if(J.model.startsWith("model")){if(p=U.find((function(e){return e.id===J.model})),!p)return[2];p.params.instance_prompt&&!g.prompt.includes(p.params.instance_prompt)&&(g.prompt=p.params.instance_prompt+", "+g.prompt)}if(J.negativePrompt&&(g.negative_prompt=J.negativePrompt),J.seed&&(g.seed=J.seed),"edit"===a&&(g.image_guidance_scale=J.imageGuidance,g.scheduler="euler_a"),J.image&&J.image.url&&(g.image_url=J.image.url),g.image_url&&"generate"===a){if(g.strength=J.strength,0===Math.floor(g.strength*g.num_inference_steps))return(0,te.yw)(i,{text:"Strength \xd7 Steps should be greater than 0",type:"danger"}),[2];f=U.find((function(e){return e.id===J.model})),"none"===J.controlnet||"stable-diffusion-v2.1"===J.model||f&&f.params.base_model&&f.params.base_model.startsWith("stabilityai/stable-diffusion-2-1")||(g.controlnet=J.controlnet,g.skip_controlnet_processing=J.skipControlnetProcessing)}"edit"===a&&(h="instruct-pix2pix")}else if("mix"===a){g.images=[],v=!0,j=!1,y=void 0;try{for(w=J.images[Symbol.iterator]();!(v=(k=w.next()).done);v=!0){if((b=k.value).loading)return(0,te.yw)(i,{text:"Please wait until all images are loaded!",type:"danger"}),[2];b.strength&&b.url&&g.images.push({url:b.url,strength:b.strength})}}catch(M){j=!0,y=M}finally{try{v||null==w.return||w.return()}finally{if(j)throw y}}if(g.images.length<1)return(0,te.yw)(i,{text:"Please upload at least 1 image!",type:"danger"}),[2];h="image-mixer"}else"upscale"===a?(g.upscale=4,g.image_url=n&&n.url,h="real-esrgan"):"enhance-face"===a&&(g.enhance_face=!0,g.image_url=n&&n.url,h="gfpgan");return x((function(e){return(0,d.Z)(Array(r).fill(1).map((function(t,a){return(0,l.Z)((0,o.Z)({},e.length?e[0]:{}),{id:Math.random().toString(),loading:!0,seed:parseInt(g.seed)+a,width:n?n.width:J.width,height:n?n.height:J.height})}))).concat((0,d.Z)(e))})),window.scrollTo({top:window.innerWidth<700?window.innerHeight:0,behavior:"smooth"}),g.node=(null===(_=G.find((function(e){return e.id===J.node})))||void 0===_?void 0:_.domain)||J.node,[4,m.Z.post("/api/models/"+h,g)];case 2:N=D.sent(),S=N.data.map((function(e){return e.id})),D.label=3;case 3:return S.length>0?[5,(0,u.__values)(c())]:[3,5];case 4:return D.sent(),[3,3];case 5:return i((0,re.FA)(-1*s)),[3,8];case 6:return(C=D.sent())&&C.response&&401===C.response.status?i((0,te.FA)("register")):(C&&C.response&&C.response.data&&i((0,te.YW)(C.response.data)),(0,te.yw)(i,{text:"Something went wrong!",type:"danger"})),x((function(e){return e.filter((function(e){return!e.loading}))})),[3,8];case 7:return H(!1),[7];case 8:return[2]}}))})),Me.apply(this,arguments)}function Pe(){return(Pe=(0,r.Z)((function(){var e,t,n,a,i,r,s,c;return(0,u.__generator)(this,(function(d){switch(d.label){case 0:if(e=new URLSearchParams(window.location.search),(t=F.Z.get("text-to-image-state"))&&((n=JSON.parse(t)).image&&delete n.image,n.images&&delete n.images,console.log("setting Cookies",g()().format("HH:mm:ss:SSS")),R((function(e){return(0,o.Z)({},e,n)}))),(a=e.get("model"))&&R((function(e){return(0,l.Z)((0,o.Z)({},e),{model:a})})),(i=e.get("ref"))&&sessionStorage.setItem("from_user",i),!(r=e.get("img")||e.get("init-img")))return[2];r&&sessionStorage.setItem("from_img",r),s=null!==e.get("shared"),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,m.Z.get("/api/images/".concat(s?"shared/":"")+r)];case 2:return c=d.sent(),e.has("img")?Ze(c.data):e.has("init-img")&&ke(c.data),[3,4];case 3:return d.sent(),[3,4];case 4:return[2]}}))}))).apply(this,arguments)}return(0,f.useEffect)((function(){!function(){ne.apply(this,arguments)}(),function(){ae.apply(this,arguments)}(),function(){Pe.apply(this,arguments)}()}),[]),(0,f.useEffect)((function(){_.id&&ge()}),[_.id]),(0,f.useEffect)((function(){J.model&&F.Z.set("text-to-image-state",JSON.stringify(J),{expires:g()().add(24,"months").toDate()})}),[J]),(0,f.useEffect)((function(){var e=function(e){if(!e.altKey&&!e.metaKey||"g"!==e.key&&"Enter"!==e.key||(e.preventDefault(),De()),w&&"ArrowRight"===e.key){var t=v.findIndex((function(e){return e.id===w.id}))+1;t<v.length&&k(v[t]),t>.7*v.length&&C.hasMore&&ge()}if(w&&"ArrowLeft"===e.key){var n=v.findIndex((function(e){return e.id===w.id}))-1;n>-1&&k(v[n])}w&&"Escape"===e.key&&k(void 0)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[_.id,J,w,v,C,T]),(0,a.jsxs)("div",{className:he()._,children:[(0,a.jsx)("div",{className:he()._controls,children:(0,a.jsxs)("div",{className:he().controls,children:[(0,a.jsx)("div",{className:he()._parameters,children:(0,a.jsxs)("div",{className:he().parameters,children:["generate"===Z?(0,a.jsx)(X,{id:"model",models:U,value:J.model,onChange:e}):null,"generate"===Z?(0,a.jsx)(pe,{id:"node",models:G,value:J.node,onChange:e}):null,"generate"===Z||"edit"===Z?(0,a.jsxs)(j,{icon:(0,a.jsx)(se.Z,{}),title:"edit"===Z?"Instruction":"Prompt",style:"plain",openByDefault:!0,children:[(0,a.jsx)(ie,{label:"edit"===Z?"Instruction":"Prompt",id:"prompt",placeholder:"edit"===Z?"Use natural language to edit the image e.g. make it a miro painting, add fireworks to the sky, what if it was an anime ...":"Describe something you'd like to see generated. Experiment with different words and styles...",value:J.prompt,onChange:e,autoFocus:!0,size:"md",noInfo:!0}),(0,a.jsx)("div",{className:he().random,children:(0,a.jsxs)(h.Z,{htmlType:"button",size:"xs",type:"default",onClick:function(){return ve.apply(this,arguments)},children:[(0,a.jsx)(oe.Z,{})," Import Civitai"]})}),(0,a.jsx)(W.Z,{label:"Negative prompt",id:"negativePrompt",placeholder:"Describe what you don't want in your image",value:J.negativePrompt,onChange:e,disableInfo:!0})]}):null,(0,a.jsxs)(j,{icon:(0,a.jsx)(le.Z,{}),title:"Generation Parameters",style:"plain",children:[(0,a.jsx)("div",{style:{height:12}}),(0,a.jsx)($,{label:"Number of images: ".concat(J.numImages),min:1,max:4,step:1,value:J.numImages,onChange:function(e){return R((0,l.Z)((0,o.Z)({},J),{numImages:e}))}}),(0,a.jsx)("div",{style:{height:24}}),(0,a.jsxs)("div",{className:he().sliders2,children:[(0,a.jsx)($,{label:"Width: ".concat(J.width),min:256,max:1024,step:64,value:J.width,onChange:function(e){return R((0,l.Z)((0,o.Z)({},J),{width:e}))}}),(0,a.jsx)($,{label:"Height: ".concat(J.height),min:256,max:1024,step:64,value:J.height,onChange:function(e){return R((0,l.Z)((0,o.Z)({},J),{height:e}))}})]}),(0,a.jsx)("div",{style:{height:24}}),(0,a.jsxs)("div",{className:he().sliders2,children:[(0,a.jsx)($,{label:"Steps: ".concat(J.steps),min:1,max:75,step:1,value:J.steps,onChange:function(e){return R((0,l.Z)((0,o.Z)({},J),{steps:e}))}}),(0,a.jsx)($,{label:"CFG scale: ".concat(J.guidanceScale),min:0,max:20,step:1,value:J.guidanceScale,onChange:function(e){return R((0,l.Z)((0,o.Z)({},J),{guidanceScale:e}))}})]}),J.steps>35?(0,a.jsxs)(A,{id:"steps-high",title:"Steps",children:["High number of steps may take a while to generate. For fast generations we recommend 20-25 steps. Learn more ",(0,a.jsx)("a",{href:"/guides/interactive-guide-to-stable-diffusion-steps-parameter",target:"_blank",children:"here"}),"."]}):(0,a.jsx)("div",{}),J.steps<14?(0,a.jsxs)(A,{id:"steps-low",title:"Steps",children:["Low number of steps may result in bad image quality or noise. We recommend 20-25 steps. Learn more ",(0,a.jsx)("a",{href:"/guides/interactive-guide-to-stable-diffusion-steps-parameter",target:"_blank",children:"here"}),"."]}):(0,a.jsx)("div",{}),J.guidanceScale>14?(0,a.jsxs)(A,{id:"guidance-scale-low",title:"CFG scale",children:["High cfg scale may result in a loss of quality. We recommend values in 7-12 range. Learn more ",(0,a.jsx)("a",{href:"/guides/interactive-guide-to-stable-diffusion-guidance-scale-parameter",target:"_blank",children:"here"}),"."]}):(0,a.jsx)("div",{}),J.guidanceScale<6?(0,a.jsxs)(A,{id:"guidance-scale-hight",title:"CFG scale",children:["Low cfg scale value may result in bad prompt interpretation. We recommend values in 7-12 range. Learn more ",(0,a.jsx)("a",{href:"/guides/interactive-guide-to-stable-diffusion-guidance-scale-parameter",target:"_blank",children:"here"}),"."]}):(0,a.jsx)("div",{}),"mix"!==Z?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{height:12}}),(0,a.jsx)(W.Z,{label:"Seed",id:"seed",placeholder:"Blank for random",value:J.seed,onChange:e,type:"number",disableInfo:!0})]}):(0,a.jsx)("div",{})]}),(0,a.jsx)(j,{icon:(0,a.jsx)(ce.Z,{}),title:"Advanced",style:"plain",children:"generate"===Z?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(Y.Z,{label:"Sampler",id:"scheduler",options:[{key:"Euler a",value:"Euler a"},{key:"Euler",value:"Euler"},{key:"LMS",value:"LMS"},{key:"Heun",value:"Heun"},{key:"DPM2",value:"DPM2"},{key:"DPM2 a",value:"DPM2 a"},{key:"DPM++ 2S a",value:"DPM++ 2S a"},{key:"DPM++ 2M",value:"DPM++ 2M"},{key:"DPM++ SDE",value:"DPM++ SDE"},{key:"DPM fast",value:"DPM fast"},{key:"DPM adaptive",value:"DPM adaptive"},{key:"LMS Karras",value:"LMS Karras"},{key:"DPM2 Karras",value:"DPM2 Karras"},{key:"DPM2 a Karras",value:"DPM2 a Karras"},{key:"DPM++ 2S a Karras",value:"DPM++ 2S a Karras"},{key:"DPM++ 2M Karras",value:"DPM++ 2M Karras"},{key:"DPM++ SDE Karras",value:"DPM++ SDE Karras"},{key:"DDIM",value:"DDIM"}],value:J.scheduler,onChange:e,noInfo:!0})}):(0,a.jsx)("div",{})})]})}),(0,a.jsxs)("form",{className:he().actions,onSubmit:De,children:[(0,a.jsx)("small",{className:"small",style:{marginBottom:6},children:(0,a.jsxs)("span",{children:["Need ",J.numImages*(1+("true"===J.upscale?1:0)+("true"===J.enhanceFace?1:0))," credit",J.numImages+(1+("true"===J.upscale?1:0)+("true"===J.enhanceFace?1:0))===1?"":"s"," for this generation."]})}),(0,a.jsx)(h.Z,{fullWidth:!0,loading:T,size:"lg",errorFor:["prompt"],onClick:function(e){window&&(null===window||void 0===window||window.gtag("event","generate",{event_category:"consume",event_label:""}))},children:(0,a.jsxs)(a.Fragment,{children:["Generat",T?"ing":"e "+J.numImages+(1===J.numImages?" image":" images"),"\xa0  ",(0,a.jsxs)("small",{className:he().keyboard,children:[(0,a.jsx)(de.Z,{})," + G"]})]})})]})]})}),(0,a.jsx)("div",{className:he().images,id:"images",children:(0,a.jsxs)(ue.Z,{dataLength:v.length,next:ge,hasMore:C.hasMore,loader:!0,className:he().infinite,children:[(0,a.jsxs)(me.Z,{breakpointCols:{default:8,2400:6,1700:4,1260:3,1024:2,840:1,760:2},className:he().grid,columnClassName:he().column,children:[v.map((function(e){return(0,a.jsx)("div",{id:e.id,className:[he().img,P===e.id?he().img_dragging:""].join(" "),draggable:!0,onDragStart:t,onDragEnd:n,children:(0,a.jsx)(E,{onCopyParams:Ze,onCopyImage:ke,onSelect:k,onDelete:Se,onUpscale:xe,onEnhanceFace:ye,image:e,hoverable:P!==e.id})},e.id)})),0==v.length&&Array(24).fill(1).map((function(e,t){return(0,a.jsx)("div",{className:he().image,style:{paddingBottom:"100%"}},t)}))]}),(0,a.jsx)("div",{style:{height:24}}),_.id&&C.hasMore?(0,a.jsxs)(h.Z,{type:"default",loading:C.loading,onClick:ge,fullWidth:!0,children:["Load",C.loading?"ing":""," more images"]}):(0,a.jsx)("div",{}),(0,a.jsx)("div",{style:{height:24}})]})}),void 0!==w?(0,a.jsxs)("div",{className:he()._overlay,children:[(0,a.jsx)("div",{className:he().overlay}),(0,a.jsx)("div",{className:he()._modal,children:(0,a.jsxs)("div",{className:he().modal,children:[(0,a.jsx)("button",{className:he().close,onClick:function(){return k(void 0)},children:(0,a.jsx)(K.Z,{size:14})}),(0,a.jsx)("div",{className:he().modal_image,children:(0,a.jsx)(_e.default,{onOutsideClick:function(){return k(void 0)},display:"contents",children:(0,a.jsx)(L.Z,(0,o.Z)({},w),w.id)})})]})})]}):null]})}function ve(){(0,ee.T)(),(0,ee.C)(re.dy),(0,ee.C)(re.ss);return(0,a.jsx)(i.Z,{title:"Generate photo-realistic images from text using Stable Diffusion",description:"We provide simple access to Stable Diffusion model, which enables generating photo-realistic images with given text input.",canonical:"/text-to-image",image:"/social-image-generator.png",footer:!1,children:(0,a.jsx)(fe,{})})}},7081:function(e){e.exports={_:"collapse____TMebO",plain:"collapse_plain__QdLTn",title:"collapse_title__5v17S",_content:"collapse__content__UCI81",_head:"collapse__head__WuwXI",head:"collapse_head__DeVhb",_open:"collapse__open__2oBUh",chevron:"collapse_chevron___zsmw",left:"collapse_left__H983u",center:"collapse_center__zC28f",right:"collapse_right__BUdkI",open:"collapse_open__DLM6y",tag:"collapse_tag__0SLu3"}},4830:function(e){e.exports={tip:"onboarding_tip__kgn_R",tip_title:"onboarding_tip_title__Y5gwv",tip_close:"onboarding_tip_close__t_rD8",title_close:"onboarding_title_close__pRMmJ",overlay:"onboarding_overlay__fKQo5",modal:"onboarding_modal__xgfgh",body:"onboarding_body__rmKC0",image:"onboarding_image__pdRz3",content:"onboarding_content__qA2yh",title:"onboarding_title__9E5Qv",text:"onboarding_text__SLvPC",footer:"onboarding_footer__XgQ_K",dots:"onboarding_dots__D6rE_",dot:"onboarding_dot__r_BoM",active:"onboarding_active__FqNIz",actions:"onboarding_actions__ozDNJ",actions1:"onboarding_actions1__D5KXw",checkbox:"onboarding_checkbox__54Ssi",close:"onboarding_close__2PFxR"}},9706:function(e){e.exports={chevron:"select_chevron__TD4NV",sm:"select_sm__HcCDz",md:"select_md__gmDVs",with_label:"select_with_label__rsca0",_select:"select__select___YYHK",select:"select_select__IGMLf",_model_select:"select__model_select__BPNHs",_controlnet_select:"select__controlnet_select__0kO3t",controlnet_select:"select_controlnet_select__jWojY",model_search:"select_model_search__WDieZ",search:"select_search__WSutL",selected_model:"select_selected_model__d45Do",tag:"select_tag__7Ik0F",arrow:"select_arrow__kkiEp",models_list:"select_models_list__KGghQ",nodes_list:"select_nodes_list__g_A53",_model:"select__model__POw9j",checked:"select_checked__QdRhu",_node:"select__node__nYlWQ",model:"select_model__o_HqZ",model_images:"select_model_images__Bfl8t",controlnet_images:"select_controlnet_images__sX1Mj",model_info:"select_model_info__TiwHW",model_desc:"select_model_desc__5wDWq",model_author:"select_model_author__K9YWH",model_name:"select_model_name__BU9cf",model_input:"select_model_input__4opLv",checked_icon:"select_checked_icon__anCiz"}},3913:function(e){e.exports={_:"ai-generator____v_yms",_controls:"ai-generator__controls___8Piq",controls:"ai-generator_controls__ArQ54",_tabs:"ai-generator__tabs__Jn0T3",tabs:"ai-generator_tabs__MP411",_parameters:"ai-generator__parameters__YgHmr",parameters:"ai-generator_parameters__vio9v",random:"ai-generator_random__f2t2a",sliders2:"ai-generator_sliders2__vf0XO",mixer_images:"ai-generator_mixer_images__VU5CX",mixer_image:"ai-generator_mixer_image__VmVkB",_dropzone:"ai-generator__dropzone__w7cHT",upload:"ai-generator_upload__yT_nG",dropzone:"ai-generator_dropzone__EevXg",dropzone_image:"ai-generator_dropzone_image__KpiLA",image_loader:"ai-generator_image_loader__KrUaw",upload_delete:"ai-generator_upload_delete__Ezf91",actions:"ai-generator_actions__gA_Xn",keyboard:"ai-generator_keyboard__5Jrgg",images:"ai-generator_images___x2l6",images_head:"ai-generator_images_head__DNtWS",infinite:"ai-generator_infinite__9oyQm",grid:"ai-generator_grid__YK64A",column:"ai-generator_column__U_i5_",img:"ai-generator_img__EKyK3",img_dragging:"ai-generator_img_dragging__qha8C",_overlay:"ai-generator__overlay__N3jJA",overlay:"ai-generator_overlay__QERFA","fade-in":"ai-generator_fade-in__S3aCC",_modal:"ai-generator__modal__a3O5t",modal:"ai-generator_modal__6guHM","slide-in":"ai-generator_slide-in__y8Ds1",modal_image:"ai-generator_modal_image__3tswV",close:"ai-generator_close__O05CU"}},6961:function(e){e.exports={_:"tooltip____JN1OT",tooltip:"tooltip_tooltip__cQsMp",_tooltip:"tooltip__tooltip__rVjJw",content:"tooltip_content__81XFO",left:"tooltip_left__xY0fy",right:"tooltip_right__yjPbH",button:"tooltip_button__QHPLK"}}},function(e){e.O(0,[662,51,691,53,884,598,42,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);